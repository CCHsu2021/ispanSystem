@addTagHelper *, MSITTeam1
@*@model IEnumerable<MSITTeam1.ViewModels.OrderAndOrderDetailViewModel>*@
@using MSITTeam1.ViewModels
@model OrderAndOrderDetailViewModel

<style>
    .filters {
        font-family: sans-serif;
    }

    .filters-content {
        margin: 2rem 0 2.5rem;
        padding: 0.375rem;
        border-radius: 0.75rem;
        display: flex;
        justify-content: space-between;
        -moz-column-gap: 0.5rem;
        column-gap: 0.5rem;
    }

    .filters__button {
        width: 100%;
        border: none;
        outline: none;
        padding: 1rem;
        background-color: #EFEFEF;
        transition: 0.3s;
        border-radius: 0.5rem;
    }

        .filters__button:hover {
            background-color: #fff;
        }

    /* Hide*/
    .filters [data-content] {
        display: none;
    }

    [data-content].is-active[data-content] {
        display: grid;
    }

    [data-target].is-active {
        background-color: #4042f6;
        color: #fff;
    }
</style>
<h3>購買紀錄</h3>
<div class="container">
    <section class="filters">
        <ul class="filters-content">
            <button class="filters__button is-active" data-target="#projects">
                產品訂單
            </button>
            <button class="filters__button" data-target="#skills">
                課程訂單
            </button>
        </ul>
        <div>
            @{
                var proID = "";
                string pid = "";
                string pidDetail = "";
                <div data-content class="is-active" id="projects">
                    @foreach (var item in Model.order)
                    {
                        pid = item.OrderId;
                        pidDetail = $"POrder{item.OrderId}";
                        <div class="oneOrder border px-3 my-3">
                            <div class="row bg-light p-3 align-items-center">
                                <div class="col-md-4">
                                    訂單號碼:@item.OrderId
                                </div>
                                <div class="col-md-3">
                                    日期:@Html.DisplayFor(modelItem => item.Date, "Date")
                                </div>
                                <div class="col-md-3">
                                    總額:@item.TotalPrice
                                </div>
                                <div class="col-md-2">
                                    <button id="@item.OrderId" class="btn btn-info">詳情</button>
                                </div>
                            </div>
                            <div id="@pidDetail" class="row align-items-center  p-3 d-none">
                                <div class="col-md-3">付款方式:@item.PayMethod</div>
                                <div class="col-md-3">寄送方式:@item.ShipBy</div>
                                <div class="col-md-2">收件人:@item.Recipient</div>
                                <div class="col-md-4">地址:@item.ShipTo</div>
                                <div class="col-12">
                                    <h5 class="mt-3 mb-2 font-weight-bold">商品清單</h5>
                                </div>

                                @foreach (var item2 in Model.orderDetail)
                                {
                                    if (item2.OrderId == item.OrderId)
                                    {

                                        @foreach (var item3 in Model.product)
                                        {
                                            
                                            if (item3.ProductId == item2.ProductId && proID!=item3.ProductId)
                                            {
                                                <div class="col-md-3">
                                                    <img src="@item3.ImgPath" />
                                                </div>
                                                <div class="col-md-3">@item3.Name</div>
                                            }
                                            proID = item3.ProductId;
                                        }
                                                <div class="col-md-3">NT$@item2.Price</div>
                                                <div class="col-md-3">@item2.Qty 個</div>
                                    }
                                }
                            </div>
                        </div>
                        <script src="~/js/jquery.js"></script>
                        <script>
                                   $("#@pid").click(function () {
                                   $(this).parents().find("#@pidDetail").toggleClass("d-none");
                                   })
                        </script>
                    }
                    <div id="POrderPagination" class="row my-4"></div>
                </div>
            }

            <div data-content id="skills">
                <h2>Skills</h2>
            </div>
        </div>
    </section>
</div>
<script>
    $(function () {
        initPagination('.oneOrder', 5, '#POrderPagination')
    });
</script>
